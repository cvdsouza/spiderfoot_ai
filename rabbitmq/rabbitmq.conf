## RabbitMQ TLS-only configuration for SpiderFoot
##
## Plain AMQP (port 5672) is disabled. All clients must connect via
## AMQPS (port 5671) using the self-signed CA certificate in certs/ca.crt.
##
## To use your own certificates, replace the files in the certs/ directory
## and restart (./stop.sh && ./start.sh).

# ── Disable the unencrypted AMQP listener ────────────────────────────────────
listeners.tcp = none

# ── Enable the TLS AMQP listener ─────────────────────────────────────────────
listeners.ssl.default = 5671

# ── TLS certificate paths (mounted from certs/ directory) ────────────────────
ssl_options.cacertfile = /etc/rabbitmq/certs/ca.crt
ssl_options.certfile   = /etc/rabbitmq/certs/server.crt
ssl_options.keyfile    = /etc/rabbitmq/certs/server.key

# ── TLS settings ──────────────────────────────────────────────────────────────
# verify_none — do not require client certificates (server-side TLS only)
ssl_options.verify               = verify_none
ssl_options.fail_if_no_peer_cert = false

# Require TLS 1.2 or higher
ssl_options.versions.1 = tlsv1.2
ssl_options.versions.2 = tlsv1.3

# ── Logging ───────────────────────────────────────────────────────────────────
log.console          = true
log.console.level    = info
